<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover" />
<title>Bora... Crescer! ‚Äî v2.8</title>
<meta name="theme-color" content="#0e0f13" />
<style>
  :root{
    --bg:#0e0f13; --ink:#eaf0ff; --muted:#9fb0d9; --line:#2b3042;
    --accent:#5fb3ff; --accent2:#f7d040;
    --gridOpacity:.22; --brushOpacity:.18; --grainOpacity:.08; --shineOpacity:.28;
    --ring: rgba(121,200,255,.14); --ring2: rgba(247,208,64,.14);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:var(--bg); color:var(--ink); overflow:hidden;
    -webkit-font-smoothing:antialiased; text-rendering:optimizeLegibility;
    -webkit-tap-highlight-color:transparent; touch-action:manipulation;
    font-family:Inter, Segoe UI, system-ui, -apple-system, Roboto, Arial, sans-serif;
  }
  .hidden{display:none !important}

  /* ===== Fundo met√°lico ===== */
  .metal-bg{ position:fixed; inset:0; overflow:hidden; z-index:0; }
  .layer{ position:absolute; inset:-6% }
  .base{
    background:
      radial-gradient(1200px 800px at 20% 15%, #141722 0%, transparent 60%),
      radial-gradient(1000px 700px at 80% 85%, #0f121b 0%, transparent 60%),
      linear-gradient(135deg, #0f1217 0%, #0c0f14 100%);
  }
  .brush{
    background: repeating-linear-gradient(90deg, rgba(255,255,255,0) 0px, rgba(255,255,255,.18) .5px, rgba(255,255,255,0) 1.2px, rgba(0,0,0,0) 3px);
    mix-blend-mode:soft-light; opacity:var(--brushOpacity);
  }
  .grid{
    --size:56px; --dot:1.8px; --gap:3.2px;
    background: radial-gradient(circle at 1px 1px, rgba(255,255,255,var(--gridOpacity)) var(--dot), transparent calc(var(--dot) + var(--gap)));
    background-size: var(--size) var(--size);
    mix-blend-mode:overlay;
  }
  .shine{
    inset:-12%;
    background: conic-gradient(from 180deg at 50% 50%, rgba(255,255,255,0) 0deg, rgba(255,255,255,var(--shineOpacity)) 22deg, rgba(95,179,255,.16) 48deg, rgba(255,255,255,0) 110deg);
    filter: blur(44px) saturate(115%); opacity:.55; animation:autoShine 9s linear infinite;
  }
  @keyframes autoShine{ 0%{transform:rotate(0)} 60%{transform:rotate(1.3deg)} 100%{transform:rotate(0)} }
  .grain{
    background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="160" height="160" viewBox="0 0 160 160"><filter id="n"><feTurbulence type="fractalNoise" baseFrequency="0.9" numOctaves="2" stitchTiles="stitch"/></filter><rect width="100%" height="100%" filter="url(%23n)" opacity="0.6"/></svg>');
    background-size:220px 220px; mix-blend-mode:soft-light; opacity:var(--grainOpacity);
  }

  /* ===== Estruturas ===== */
  .screen{
    position:absolute; inset:0; z-index:1; display:none; opacity:0; transition:opacity .35s ease;
    padding:calc(env(safe-area-inset-top) + 88px) 16px calc(env(safe-area-inset-bottom) + 72px);
    overflow:auto;
  }
  .screen.active{display:block; opacity:1}
  .center{ display:grid; place-items:center; min-height:calc(100dvh - 160px) }

  /* ===== Header/rodap√© ===== */
  .header{
    position:fixed; top:0; left:0; right:0; height:72px; z-index:3;
    display:flex; align-items:center; justify-content:center;
    background:linear-gradient(180deg,rgba(25,27,36,.65),rgba(25,27,36,.18));
    backdrop-filter:blur(6px); border-bottom:1px solid var(--line);
    padding-top:env(safe-area-inset-top);
  }
  .hdr-left,.hdr-right{ position:absolute; inset:0 0 auto 0; height:72px; display:flex; align-items:center; gap:10px; padding:0 12px }
  .hdr-left{ justify-content:flex-start } .hdr-right{ justify-content:flex-end }
  .user-badge{ display:flex; align-items:center; gap:8px; border:1px solid var(--line); background:#141722; border-radius:999px; padding:8px 10px; color:#cfe0ff; visibility:hidden }
  .hdr-logo{ position:relative; width:180px; height:88px; display:grid; place-items:center }
  .hdr-logo img{ height:120px; object-fit:contain; transform:translateY(16px); filter:drop-shadow(0 10px 28px rgba(120,150,255,.35)) } /* metade pra fora */
  .hdr-btn{ background:#151823; border:1px solid #2f3650; color:#d5e4ff; border-radius:12px; padding:8px 12px; font-weight:800; cursor:pointer }
  .hdr-btn:focus-visible{ outline:2px solid #79c8ff; outline-offset:2px }

  .footer{
    position:fixed; left:0; right:0; bottom:0; height:60px; z-index:3;
    display:flex; align-items:center; justify-content:space-between; gap:8px; padding:0 12px calc(env(safe-area-inset-bottom));
    background:linear-gradient(0deg,rgba(25,27,36,.65),rgba(25,27,36,.18)); border-top:1px solid var(--line);
  }
  .foot-btn{
    display:inline-flex; align-items:center; gap:8px; border:1px solid var(--line);
    background:#141722; color:#cfe0ff; border-radius:999px; padding:10px 14px; font-weight:800; cursor:pointer
  }
  .foot-btn.neon{ border-color:#4bd1ff; box-shadow:0 0 0 6px rgba(79,199,255,.12), 0 0 18px rgba(79,199,255,.35) inset; color:#aee3ff }
  .foot-btn:focus-visible{ outline:2px solid #79c8ff; outline-offset:2px }

  /* ===== Splash ===== */
  .stage{ position:fixed; inset:0; z-index:2; display:grid; place-items:center; height:100dvh; }
  .cover{ display:grid; place-items:center; width:min(92vmin, 100vw); height:min(92vmin, 100dvh) }
  .halo{ position:absolute; inset:-14%; border-radius:50%; background:radial-gradient(closest-side, rgba(95,179,255,.18), transparent 70%), radial-gradient(closest-side, rgba(255,255,255,.1), transparent 60%); filter:blur(10px); opacity:0; transform:scale(.78); animation:haloIn .9s ease forwards .2s }
  @keyframes haloIn{ to{opacity:1; transform:scale(1)} }
  .logo{ width:100%; height:100%; object-fit:contain; filter:drop-shadow(0 10px 28px rgba(0,0,0,.45)); opacity:0; transform:translateY(18px) scale(.94); animation:logoIn 1.1s cubic-bezier(.2,.8,.2,1) forwards .3s, floatPulse 2.2s ease-in-out infinite 1.4s }
  @keyframes logoIn{ to{opacity:1; transform:translateY(0) scale(1)} }
  @keyframes floatPulse{ 0%,100%{transform:translateY(0)} 50%{transform:translateY(-10px)} }

  /* ===== UI base ===== */
  .card{
    background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.01));
    border:1px solid var(--line); border-radius:16px; padding:18px;
    width:min(760px, 94vw); max-width:94vw; margin:auto;
    box-shadow:0 10px 36px rgba(0,0,0,.28), inset 0 1px 0 rgba(255,255,255,.03)
  }
  .title{
    font-weight:900; letter-spacing:.02em; margin:0 0 10px; text-align:center; color:#dfe7ff;
    text-shadow:0 0 18px rgba(220,230,255,.3), 0 0 6px rgba(220,230,255,.2);
    background:linear-gradient(90deg,#bfc9d9,#eaf0ff,#c8d4ea); -webkit-background-clip:text; background-clip:text; -webkit-text-fill-color:transparent
  }
  .hint{ color:var(--muted); font-size:.92rem; text-align:center }
  .row{ display:flex; flex-wrap:wrap; gap:10px; justify-content:center }
  .btn{
    background:linear-gradient(180deg,#2a2f3b,#1c1f26); border:1px solid #3a3f4f; color:#e9eeff;
    padding:12px 16px; border-radius:12px; font-weight:800; cursor:pointer; position:relative;
    transition:transform .05s ease, box-shadow .2s ease, border-color .2s ease;
  }
  .btn:focus-visible{ outline:2px solid #79c8ff; outline-offset:2px }
  .btn.neon-hit,.btn:active{ border-color:#79c8ff; box-shadow:0 0 0 6px var(--ring), 0 0 22px rgba(121,200,255,.35) inset; transform:translateY(-1px) }
  .btn.selected{ border-color:#ffd878; box-shadow:0 0 0 6px var(--ring2), 0 0 22px rgba(247,208,64,.35) inset }
  .btn-primary{
    background: radial-gradient(140% 120% at 30% -20%, rgba(247,208,64,.18), transparent 50%), linear-gradient(180deg,#2e2a18,#171612);
    border-color:#6b5c1f; color:#ffe6a2
  }

  /* Avatares (3 bolinhas) */
  .avatar-dots{ display:flex; gap:14px; justify-content:center; margin:10px 0 6px }
  .dot{ width:72px; height:72px; border-radius:50%; display:grid; place-items:center; border:1px solid var(--line); background:linear-gradient(180deg,#1e2027,#16171c); font-size:28px; cursor:pointer; transition:transform .18s ease, border-color .18s ease, box-shadow .18s ease }
  .dot:active{ transform:translateY(1px) }
  .dot.active{ border-color:#7ad1ff; box-shadow:0 0 0 6px rgba(122,209,255,.18), 0 0 26px rgba(122,209,255,.36) inset, 0 0 24px rgba(122,209,255,.25); transform:translateY(-2px) }
  .dot:focus-visible{ outline:2px solid #79c8ff; outline-offset:2px }

  /* Neon frames */
  .neon-frame{ border-color:#79c8ff; box-shadow:0 0 0 6px rgba(121,200,255,.10), 0 0 26px rgba(121,200,255,.22) inset }
  .neon-lite{ border-color:#5fb3ff; box-shadow:0 0 0 4px rgba(95,179,255,.10), inset 0 0 18px rgba(95,179,255,.18) }

  /* Modal senha */
  .modal{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; padding:20px; background:rgba(7,8,12,.86); z-index:4 }
  .modal.show{ display:flex }
  .sheet{ width:min(520px,94vw); max-height:92vh; overflow:auto; background:linear-gradient(180deg,#171a22,#12141a); border:1px solid #2c3243; border-radius:16px; padding:16px; box-shadow:0 10px 36px rgba(0,0,0,.36); box-sizing:border-box }
  .sheet-head{ display:flex; align-items:center; justify-content:space-between; margin-bottom:8px; position:sticky; top:0; background:linear-gradient(180deg,#171a22,#12141a); padding-bottom:6px }
  .user-mini{ display:flex; align-items:center; gap:10px; font-weight:800 }
  .input{ width:100%; background:#0f1118; border:1px solid #2b3042; border-radius:12px; color:#e9eeff; padding:12px 14px; font-size:1rem }

  /* ===== Calend√°rio ===== */
  .cal-wrap{ width:min(760px,96vw); margin:auto }
  .cal-head{ display:flex; align-items:center; justify-content:space-between; margin-bottom:10px }
  .ai-row{ display:flex; align-items:center; gap:8px; color:#cfe2ff }
  .ai-ico{ font-size:18px; filter:drop-shadow(0 0 10px rgba(95,179,255,.35)) }
  .grid-days{ display:grid; grid-template-columns:repeat(7, minmax(36px,1fr)); gap:8px }
  .d{ aspect-ratio:1/1; border:1px solid #3a3f4f; border-radius:999px; display:grid; place-items:center; cursor:pointer; background:#1a1d27; font-weight:800 }
  .d.done{ background:#0f141c; border-color:#2f6; color:#b8ffd2 }
  .d.today{ border-color:#79c8ff; box-shadow:0 0 0 6px rgba(121,200,255,.12) inset }
  .d.sel{ outline:2px solid #ffd878; outline-offset:2px; color:#231; background:#ffe7a6 }
  .cal-foot{ display:flex; gap:10px; justify-content:center; margin-top:12px }

  /* ===== Cards (perguntas) ===== */
  .emo-row{ display:flex; gap:12px; justify-content:center }
  .emo{ font-size:32px; background:none; border:none; cursor:pointer }
  .emo.active{ filter:drop-shadow(0 0 8px rgba(95,179,255,.55)) }

  .q-wrap{ width:min(820px,96vw); margin:auto }
  .q-head{ display:flex; align-items:center; justify-content:space-between; gap:8px; margin-bottom:8px }
  .badge{ display:flex; align-items:center; gap:8px }
  .dotcat{ width:28px; height:28px; border-radius:50%; display:grid; place-items:center; background:#ffd878; color:#231; font-weight:900 }
  .q-title{ font-weight:800 }
  .q-body{ background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.01)); border:1px solid var(--line); border-radius:14px; padding:14px }
  .q-actions{ display:flex; align-items:center; gap:8px; margin-top:10px; justify-content:space-between; flex-wrap:wrap }
  .lamp{ background:transparent; border:1px dashed #3b4157; border-radius:999px; padding:6px 10px; cursor:pointer }
  .ex-box{ display:none; margin-top:10px; border:1px solid #2e3446; background:#101219; border-radius:12px; padding:10px 12px; color:#cfe2ff }
  .ex-box.show{ display:block }
  .slider{ width:100% }
  .score{ font-weight:900 }

  /* ===== Toast IA ===== */
  .toast{
    position:fixed; right:14px; bottom:78px; width:min(420px, 92vw); z-index:5;
    border:1px solid #2c3243; background:linear-gradient(180deg,#171a22,#11131a); color:#dfe7ff;
    border-radius:14px; padding:12px 14px; box-shadow:0 14px 36px rgba(0,0,0,.5); display:none;
  }
  .toast.show{ display:block; animation:pop .18s ease }
  @keyframes pop{ from{ transform:translateY(6px); opacity:.0 } to{ transform:translateY(0); opacity:1 } }
  .toast-head{ display:flex; align-items:center; justify-content:space-between; gap:8px; margin-bottom:6px }
  .toast-title{ display:flex; align-items:center; gap:8px; font-weight:900 }
  .toast-close{ background:#1a1d27; border:1px solid #2b3042; color:#cfe0ff; border-radius:999px; padding:6px 10px; cursor:pointer }

  /* ===== Resultados ===== */
  .grid{ display:grid; grid-template-columns:1fr; gap:12px; width:min(1200px,96vw); margin:auto }
  @media(min-width:1100px){ .grid{ grid-template-columns:1.15fr .85fr } }
  .mini{ height:180px; border:1px dashed #2e3342; border-radius:12px; display:flex; align-items:center; justify-content:center; overflow:hidden }
  .filters{ display:flex; gap:8px; flex-wrap:wrap; justify-content:space-between; align-items:center; margin:6px 0 4px }
  .select{ background:#141722; border:1px solid #2f3650; color:#dfe7ff; border-radius:10px; padding:8px 10px; }
  .kpis{ display:flex; gap:12px; flex-wrap:wrap; align-items:center; justify-content:space-between }

  /* ===== Wipe (contagem) ===== */
  .wipe{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; flex-direction:column; background:radial-gradient(1200px 800px at 50% -10%, #121521 0%, #0b0c12 60%); z-index:50 }
  .wipe.show{ display:flex }
  .wipe .count{ font-size:72px; font-weight:900 }
  .wipe .phrase{ margin-top:10px; font-size:1.05rem; color:#cfe2ff; text-align:center; padding:0 16px }
</style>
</head>
<body>
  <!-- Fundo -->
  <div class="metal-bg" aria-hidden="true">
    <div class="layer base"></div>
    <div class="layer brush"></div>
    <div class="layer grid"></div>
    <div class="layer shine"></div>
    <div class="layer grain"></div>
  </div>

  <!-- Header/rodap√© -->
  <header class="header hidden" id="appHeader">
    <div class="hdr-left"><div class="user-badge" id="userBadge"><span id="hdrAv">üôÇ</span><span id="hdrNm">‚Äî</span></div></div>
    <a class="hdr-logo" href="#" id="homeLogo" aria-label="In√≠cio"><img src="123.png" alt=""></a>
    <div class="hdr-right">
      <a class="hdr-btn" href="configuracao.html" title="Configura√ß√£o">‚öôÔ∏è</a>
      <a class="hdr-btn" href="cadastro.html" title="Cadastro">ü™™</a>
    </div>
  </header>
  <footer class="footer hidden" id="appFooter">
    <button class="foot-btn" id="btnSheets"><span>Sheets</span> <strong id="sState">OFF</strong></button>
    <button class="foot-btn" id="btnAI"><span>IA</span> <strong id="aiState">OFF</strong></button>
    <a class="foot-btn" id="btnHome" href="#" title="P√°gina inicial">üè† Home</a>
  </footer>

  <!-- Splash (4s) -->
  <section id="cover" class="stage">
    <div class="cover">
      <div class="halo"></div>
      <img class="logo" src="123.png" alt="">
    </div>
  </section>

  <!-- Quem √© voc√™ -->
  <section id="who" class="screen" aria-hidden="true">
    <div class="center">
      <div class="card neon-frame">
        <h2 class="title">Quem √© voc√™?</h2>
        <p class="hint">Toque num avatar para abrir o card de senha.</p>
        <div class="avatar-dots" id="avatarDots"></div>
      </div>
    </div>
  </section>

  <!-- Dados & A√ß√µes -->
  <section id="dados" class="screen" aria-hidden="true">
    <div class="center">
      <div class="card neon-frame" style="text-align:center">
        <h2 class="title">Dados & A√ß√µes</h2>
        <div class="row">
          <button class="btn btn-primary" id="goStart">Come√ßar</button>
          <button class="btn" id="goResults">Resultados</button>
          <button class="btn" id="goHome">P√°gina Inicial</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Selecionar Data -->
  <section id="calendar" class="screen" aria-hidden="true">
    <div class="center" style="align-items:start">
      <div class="card cal-wrap neon-frame">
        <div class="cal-head">
          <h2 class="title" style="margin:0">Selecionar Data</h2>
          <div class="ai-row"><span class="ai-ico">ü§ñ</span><span id="aiMsgTop">‚Äî</span></div>
        </div>
        <div class="hint" id="whereStopped">‚Äî</div>
        <div class="grid-days" id="gridDays" style="margin-top:12px"></div>
        <div class="cal-foot">
          <button class="btn" id="btnBackDados">Voltar</button>
          <button class="btn btn-primary" id="btnContinuar" disabled>Continuar</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Mood inicial -->
  <section id="moodStart" class="screen" aria-hidden="true">
    <div class="center">
      <div class="card neon-frame" style="text-align:center">
        <h2 class="title">Como voc√™ est√° hoje?</h2>
        <div class="emo-row" id="emoRow">
          <button class="emo" data-e="1" aria-label="Triste">üòî</button>
          <button class="emo" data-e="2" aria-label="Preocupado">üòü</button>
          <button class="emo" data-e="3" aria-label="Neutro">üòê</button>
          <button class="emo" data-e="4" aria-label="Bem">üôÇ</button>
          <button class="emo" data-e="5" aria-label="Radiante">üòÉ</button>
        </div>
        <p class="hint" id="aiMsgCards"><span class="ai-ico">ü§ñ</span> Escolha como voc√™ se sente para come√ßar os 20 cards.</p>
        <div class="row" style="margin-top:10px">
          <button class="btn btn-primary" id="btnStart20" disabled>Iniciar 20 Cards</button>
        </div>
      </div>
    </div>
  </section>

  <!-- 20 Cards -->
  <section id="cards" class="screen" aria-hidden="true">
    <div class="center">
      <div class="card q-wrap neon-frame">
        <div class="q-head">
          <div class="badge">
            <div class="dotcat" id="catDot">üéØ</div>
            <div class="q-title" id="qTitle">√Årea ‚Äî N√≠vel ‚Äî (1/20)</div>
          </div>
          <div class="badge"><span id="qCount">1/20</span></div>
        </div>
        <div class="q-body neon-lite" id="qBody">
          <div id="qText" style="font-size:1.1rem; line-height:1.5">‚Äî</div>
          <div class="ex-box" id="exBox">‚Äî</div>
          <div class="q-actions">
            <button class="btn lamp" id="btnLamp">üí° Exemplo</button>
            <div style="flex:1; min-width:200px; text-align:right">
              <label class="hint" for="rng">Sua nota (0‚Äì100)</label>
              <input type="range" id="rng" class="slider" min="0" max="100" step="1" value="50" />
              <div class="hint">Valor: <span class="score" id="valShow">50</span></div>
            </div>
            <button class="btn btn-primary" id="btnNext">Continuar</button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Mood final -->
  <section id="moodEnd" class="screen" aria-hidden="true">
    <div class="center">
      <div class="card neon-frame" style="text-align:center">
        <h2 class="title">E como voc√™ se sente ap√≥s finalizar?</h2>
        <div class="emo-row" id="emoRowEnd">
          <button class="emo" data-e="1" aria-label="Pior">üòî</button>
          <button class="emo" data-e="2" aria-label="Cansado">üòü</button>
          <button class="emo" data-e="3" aria-label="Igual">üòê</button>
          <button class="emo" data-e="4" aria-label="Melhor">üôÇ</button>
          <button class="emo" data-e="5" aria-label="√ìtimo">üòÉ</button>
        </div>
        <div class="row" style="margin-top:10px">
          <button class="btn btn-primary" id="btnSeeResults">Ver resultados</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Resultados -->
  <section id="results" class="screen" aria-hidden="true" style="align-items:stretch">
    <div class="grid">
      <div class="card neon-frame" style="grid-column:1 / -1">
        <div class="q-head"><div class="q-title">üìà Resumo & Gr√°ficos ‚Äî Hoje vs. √öltima</div><div class="hint" id="resDates">‚Äî</div></div>
        <div class="filters">
          <div class="row" style="gap:8px">
            <label class="hint">√Årea:
              <select id="selArea" class="select"></select>
            </label>
            <label class="hint">Per√≠odo:
              <select id="selPeriodo" class="select">
                <option value="3">3</option><option value="7">7</option><option value="12">12</option><option value="15">15</option><option value="20">20</option><option value="all">Tudo</option>
              </select>
            </label>
          </div>
          <div class="kpis">
            <div class="hint">Nota geral: <b id="kpiGeral">‚Äî</b></div>
            <div class="hint">Mood inicial: <b id="kpiMoodIn">‚Äî</b> ‚Ä¢ Final: <b id="kpiMoodOut">‚Äî</b></div>
            <div class="hint">Melhor √°rea: <b id="kpiBest">‚Äî</b> ‚Ä¢ Pior √°rea: <b id="kpiWorst">‚Äî</b></div>
          </div>
        </div>
        <div class="mini" id="radarWrap">‚Äî</div>
        <div class="hint">Cheio = sess√£o atual ‚Ä¢ Pontilhado = √∫ltima sess√£o.</div>
      </div>

      <div class="card neon-frame" style="grid-column:1 / -1">
        <div class="q-head"><div class="q-title">üìä S√©rie ‚Äî 3 / 7 / 12 / 15 / 20 dias</div></div>
        <div class="mini" id="seriesWrap">‚Äî</div>
      </div>

      <div class="card neon-frame" style="grid-column:1 / -1">
        <div class="q-head"><div class="q-title">üß© Geral & por √Årea</div></div>
        <div class="mini" id="barsWrap">‚Äî</div>
      </div>

      <div class="card neon-frame" style="grid-column:1 / -1">
        <div class="q-head"><div class="q-title">ü§ñ An√°lise da IA</div></div>
        <div class="hint" id="aiAnalise">‚Äî</div>
      </div>

      <div class="card neon-frame" style="grid-column:1 / -1">
        <div class="q-head"><div class="q-title">üîß Plano de Atividade</div></div>
        <div class="hint" id="sugestoes">‚Äî</div>
        <div class="bar" style="height:8px"></div>
        <div class="hint" style="text-align:left">
          Recomenda√ß√µes: livros (H√°bitos At√¥micos; Essencialismo), filmes (√Ä Procura da Felicidade; O Jogo da Imita√ß√£o), profissionais (TCC; educador f√≠sico).  
          <br><b>Aviso:</b> este app n√£o substitui profissionais especializados.
        </div>
        <div class="row" style="margin-top:10px">
          <button class="btn" id="btnEmail">Enviar relat√≥rio por e-mail</button>
          <button class="btn" id="btnFinish">Finalizar e reiniciar</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Toast IA -->
  <div class="toast" id="toast">
    <div class="toast-head">
      <div class="toast-title"><span class="ai-ico">ü§ñ</span><span id="toastTitle">Assistente</span></div>
      <button class="toast-close" id="toastClose">Fechar</button>
    </div>
    <div id="toastBody">‚Äî</div>
  </div>

  <!-- Wipe -->
  <div class="wipe" id="wipe">
    <div class="count" id="countNum">3</div>
    <div class="phrase" id="countPhrase">‚Äî</div>
  </div>

  <!-- Modal senha -->
  <div class="modal" id="loginModal" aria-hidden="true">
    <div class="sheet">
      <div class="sheet-head">
        <div class="user-mini"><span id="mIco">üôÇ</span><span id="mName">Usu√°rio</span></div>
        <button class="hdr-btn" id="mClose">Fechar</button>
      </div>
      <div class="card neon-frame" style="margin:0">
        <h3 class="title" style="font-size:1.1rem">Quem √© voc√™?</h3>
        <input id="pwd" type="password" class="input" placeholder="Senha (demo: 1234)" autocomplete="off" />
        <div class="row" style="margin-top:10px"><button class="btn btn-primary" id="btnUnlock">Entrar</button></div>
      </div>
    </div>
  </div>

<script>
/* ===== Utils ===== */
const $ = s => document.querySelector(s);
const $$ = s => document.querySelectorAll(s);
function showChrome(show){ $('#appHeader').classList.toggle('hidden', !show); $('#appFooter').classList.toggle('hidden', !show); }
function goto(id){
  $$('.screen').forEach(s=>{ s.classList.remove('active'); s.setAttribute('aria-hidden','true'); });
  const el = '#'+id; $(el).classList.add('active'); $(el).setAttribute('aria-hidden','false');
  window.scrollTo(0,0);
}
function neonHit(btn){ btn.classList.add('neon-hit'); setTimeout(()=>btn.classList.remove('neon-hit'), 180); }
function selectify(btn){ $$('.btn.selected').forEach(x=>x.classList.remove('selected')); btn.classList.add('selected'); }
function toast(msg, title='Assistente'){ if(!App.ia) return; $('#toastTitle').textContent = title; $('#toastBody').textContent = msg; $('#toast').classList.add('show'); }
$('#toastClose').addEventListener('click', ()=> $('#toast').classList.remove('show'));

/* Neon global em todos os bot√µes (feedback curto) */
document.addEventListener('click', (e)=>{
  const b = e.target.closest('.btn');
  if(!b) return;
  neonHit(b);
  b.classList.add('selected');
  setTimeout(()=> b.classList.remove('selected'), 1200);
}, {passive:true});

/* ===== Estado ===== */
let App={user:null, sheets:false, ia:false, level:1, selectedDay:null, moodIn:null, moodOut:null};
const USERS_KEY='bc_users_v2';
const USERLV_KEY= name => `bc_level_${name}`;
const TODAY = new Date();
const yyyy = TODAY.getFullYear(), mm = TODAY.getMonth()+1, dd = TODAY.getDate();
const DAYSKEY = u => `bc_days_${u}_${yyyy}_${mm}`;
const SESSKEY = u => `bc_sessions_${u}`;

/* ===== Splash 4s e vai pra Who ===== */
showChrome(false);
setTimeout(()=>{
  showChrome(true);
  $('#cover')?.remove();
  goto('who');
}, 4000);

/* ===== Header ===== */
$('#btnHome').addEventListener('click', (e)=>{ e.preventDefault(); location.reload(); });
$('#homeLogo').addEventListener('click', (e)=>{ e.preventDefault(); location.reload(); });

/* ===== Rodap√© toggles ===== */
$('#btnSheets').addEventListener('click', (e)=>{ App.sheets=!App.sheets; $('#sState').textContent=App.sheets?'ON':'OFF'; e.currentTarget.classList.toggle('neon', App.sheets); });
$('#btnAI').addEventListener('click', (e)=>{ App.ia=!App.ia; $('#aiState').textContent=App.ia?'ON':'OFF'; e.currentTarget.classList.toggle('neon', App.ia); });

/* ===== Users + n√≠vel salvo ===== */
function getUsers(){ try{ return JSON.parse(localStorage.getItem(USERS_KEY)||'null') || [{name:'Rafa',icon:'üë§'},{name:'Nina',icon:'üßë‚ÄçüöÄ'},{name:'Kai',icon:'üë©‚Äçüíª'}]; }catch{ return [{name:'Rafa',icon:'üë§'},{name:'Nina',icon:'üßë‚ÄçüöÄ'},{name:'Kai',icon:'üë©‚Äçüíª'}]; } }
function getLevel(name){ return Number(localStorage.getItem(USERLV_KEY(name))||'1'); }
function setLevel(name, lv){ localStorage.setItem(USERLV_KEY(name), String(lv)); }

/* ===== Avatares (abre modal) ===== */
(function buildAvatars(){
  const wrap=$('#avatarDots'); wrap.innerHTML='';
  getUsers().forEach(u=>{
    const b=document.createElement('button'); b.type='button'; b.className='dot'; b.innerHTML=`<span>${u.icon}</span>`;
    const openModal=()=>{
      $$('#avatarDots .dot').forEach(x=>x.classList.remove('active'));
      b.classList.add('active');
      App.user=u; App.level=getLevel(u.name)||1;
      $('#hdrAv').textContent=u.icon; $('#hdrNm').textContent=u.name; $('#userBadge').style.visibility='visible';
      $('#mIco').textContent=u.icon; $('#mName').textContent=`${u.name} ‚Äî N√≠vel ${App.level}`;
      $('#pwd').value=''; $('#loginModal').classList.add('show'); setTimeout(()=>$('#pwd').focus(),60);
      toast(`Ol√°, ${u.name}. Se preferir, ative IA no rodap√© para receber dicas.`, 'ü§ñ Assistente');
    };
    b.addEventListener('click', openModal, {passive:true});
    b.addEventListener('touchend', (e)=>{ e.preventDefault(); openModal(); }, {passive:false});
    wrap.appendChild(b);
  });
})();

/* ===== Login ===== */
$('#mClose').addEventListener('click', ()=> $('#loginModal').classList.remove('show'));
function tryUnlock(){
  if(!App.user) return alert('Escolha um avatar.');
  const v=$('#pwd').value.trim();
  if(!v) return alert('Digite a senha.');
  if(v!=='1234') return alert('Senha incorreta (demonstra√ß√£o: 1234).');
  $('#loginModal').classList.remove('show');
  goto('dados');
}
$('#btnUnlock').addEventListener('click', ()=> tryUnlock());
$('#pwd').addEventListener('keydown', (e)=>{ if(e.key==='Enter'){ e.preventDefault(); tryUnlock(); }});

/* ===== A√ß√µes ===== */
$('#goStart').addEventListener('click', (e)=>{ selectify(e.currentTarget); openCalendar(); });
$('#goResults').addEventListener('click', (e)=>{ selectify(e.currentTarget); openResultsSummary(); });
$('#goHome').addEventListener('click', ()=> location.reload());

/* ===== Calend√°rio ===== */
function doneDays(){ try{ return JSON.parse(localStorage.getItem(DAYSKEY(App.user.name))||'[]'); }catch{return []} }
function saveDone(day){
  const set=new Set(doneDays()); set.add(day); localStorage.setItem(DAYSKEY(App.user.name), JSON.stringify([...set].sort((a,b)=>a-b)));
}
function openCalendar(){ buildCalendar(); goto('calendar'); if(App.ia) toast('Dica: escolha hoje; se j√° concluiu, selecione o pr√≥ximo vazio.', 'ü§ñ Calend√°rio'); }
function buildCalendar(){
  const grid=$('#gridDays'); grid.innerHTML='';
  const done=new Set(doneDays()); let lastDone=0; done.forEach(d=>{ if(d>lastDone) lastDone=d; });
  $('#whereStopped').textContent = lastDone ? `Voc√™ parou no dia ${lastDone}.` : `Voc√™ ainda n√£o come√ßou este m√™s.`;
  $('#aiMsgTop').textContent = phrasesDD[ (dd-1)%phrasesDD.length ];
  const days = new Date(yyyy, mm, 0).getDate();
  for(let i=1;i<=days;i++){
    const b=document.createElement('button'); b.type='button'; b.className='d'; b.textContent=i;
    if(done.has(i)) b.classList.add('done');
    if(i===dd) b.classList.add('today');
    b.addEventListener('click', ()=>{
      $$('#gridDays .d').forEach(x=>x.classList.remove('sel'));
      b.classList.add('sel'); App.selectedDay=i; $('#btnContinuar').disabled=false;
    }, {passive:true});
    grid.appendChild(b);
  }
  const auto = done.has(dd) ? Math.min(lastDone+1, days) : dd;
  const autoBtn = [...grid.children][auto-1]; if(autoBtn) autoBtn.click();
}
$('#btnBackDados').addEventListener('click', ()=> goto('dados'));
$('#btnContinuar').addEventListener('click', ()=>{
  runWipe(3, phrasesDD[(App.selectedDay-1)%phrasesDD.length], ()=>{ goto('moodStart'); if(App.ia) toast(`Hoje √© dia ${String(App.selectedDay).padStart(2,'0')}. Respira e vamos leve.`, 'ü§ñ Abertura'); });
});

/* ===== Mood inicial ===== */
$('#emoRow').addEventListener('click', (e)=>{
  const el=e.target.closest('.emo'); if(!el) return;
  $$('#emoRow .emo').forEach(x=>x.classList.remove('active')); el.classList.add('active');
  App.moodIn = Number(el.dataset.e);
  $('#btnStart20').disabled=false;
});
$('#btnStart20').addEventListener('click', ()=>{ prepQuestions(); goto('cards'); });

/* ===== Base de perguntas ===== */
const AREAS=["Autoconhecimento","Resili√™ncia Emocional","Sa√∫de F√≠sica B√°sica","Performance e Vitalidade","Aprendizado Cont√≠nuo","Pensamento Cr√≠tico","Carreira e Prop√≥sito","Finan√ßas Pessoais","Investimento e Riqueza","Relacionamentos √çntimos","C√≠rculo Social","Lazer e Cultura","Espiritualidade","Contribui√ß√£o Social","Ambiente e Organiza√ß√£o"];
const ICONS={"Autoconhecimento":"üß≠","Resili√™ncia Emocional":"üß†","Sa√∫de F√≠sica B√°sica":"üí™","Performance e Vitalidade":"‚ö°","Aprendizado Cont√≠nuo":"üìö","Pensamento Cr√≠tico":"üß©","Carreira e Prop√≥sito":"üéØ","Finan√ßas Pessoais":"üíº","Investimento e Riqueza":"üìà","Relacionamentos √çntimos":"üíû","C√≠rculo Social":"ü§ù","Lazer e Cultura":"üé®","Espiritualidade":"‚ú®","Contribui√ß√£o Social":"üåç","Ambiente e Organiza√ß√£o":"üßπ"};
const LV1 = a=>[`Hoje voc√™ fez 1 micro-a√ß√£o pr√°tica ligada a ${a}?`,`Voc√™ reservou 10‚Äì15 minutos para agir em ${a}?`];
const LV2 = a=>[`Voc√™ transformou reflex√£o em a√ß√£o concreta em ${a}?`,`Voc√™ mediu seu progresso em ${a} hoje?`];
const LV3 = a=>[`Voc√™ sustentou ${a} com qualidade mesmo sob press√£o?`,`Voc√™ documentou e padronizou 1 boa pr√°tica de ${a}?`];
const EXS = a=>({1:`Ex.: 10 min focado em ${a}.`,2:`Ex.: medir e anotar 1 dado de ${a}.`,3:`Ex.: padronizar seu m√©todo em ${a}.`});
const CAT_COLORS = {
  "Autoconhecimento":"#8ecbff","Resili√™ncia Emocional":"#88e7ff","Sa√∫de F√≠sica B√°sica":"#7ee78f","Performance e Vitalidade":"#ffd45c","Aprendizado Cont√≠nuo":"#9aa9ff","Pensamento Cr√≠tico":"#caa8ff","Carreira e Prop√≥sito":"#ffb86b","Finan√ßas Pessoais":"#88e1c1","Investimento e Riqueza":"#a4ff6b","Relacionamentos √çntimos":"#ff8fb3","C√≠rculo Social":"#8fe3ff","Lazer e Cultura":"#ffc06b","Espiritualidade":"#b7a6ff","Contribui√ß√£o Social":"#8ff5b2","Ambiente e Organiza√ß√£o":"#a0c9ff"
};

let Q=[], qi=0, answers=[];
function prepQuestions(){
  Q=[]; qi=0; answers=[];
  const level = App.level||1;
  const pool = [...AREAS].sort(()=>Math.random()-.5).slice(0,10);
  pool.forEach(a=>{
    const gen = level===1?LV1:level===2?LV2:LV3;
    const ex = EXS(a)[level];
    const arr = gen(a).map(t=>({area:a,level,txt:t,ex,icon:ICONS[a]}));
    Q.push(...arr);
  });
  Q.sort(()=>Math.random()-.5);
  renderQ();
}
function renderQ(){
  const cur=Q[qi];
  $('#qTitle').textContent = `${cur.area} ‚Äî N√≠vel ${cur.level} ‚Äî (${qi+1}/20)`;
  $('#catDot').textContent = cur.icon || 'üéØ';
  $('#qText').textContent = cur.txt;
  $('#exBox').classList.remove('show'); $('#exBox').textContent = cur.ex;
  $('#rng').value=50; $('#valShow').textContent='50';
  $('#qCount').textContent = `${qi+1}/20`;
  // Neon por categoria (borda + glow)
  const c = CAT_COLORS[cur.area] || '#5fb3ff';
  $('#catDot').style.background = c;
  const qb = $('#qBody');
  qb.style.borderColor = c;
  qb.style.boxShadow = `0 0 0 6px ${c}22 inset, 0 0 24px ${c}33 inset`;
  neonBackdrop(cur.area);
}
$('#btnLamp').addEventListener('click', ()=> $('#exBox').classList.toggle('show'));
$('#rng').addEventListener('input', (e)=> $('#valShow').textContent = e.target.value);
$('#btnNext').addEventListener('click', ()=>{
  answers.push({ ...Q[qi], val: Number($('#rng').value) });
  qi++;
  if(qi<20) renderQ();
  else goto('moodEnd');
});

/* ===== Mood final ===== */
$('#emoRowEnd').addEventListener('click', (e)=>{
  const el=e.target.closest('.emo'); if(!el) return;
  $$('#emoRowEnd .emo').forEach(x=>x.classList.remove('active')); el.classList.add('active');
  App.moodOut = Number(el.dataset.e);
});
$('#btnSeeResults').addEventListener('click', ()=>{ computeResults(); goto('results'); });

/* ===== Resultados / Hist√≥rico ===== */
function saveSession(payload){
  const key=SESSKEY(App.user.name);
  const hist=JSON.parse(localStorage.getItem(key)||'[]'); hist.push(payload);
  localStorage.setItem(key, JSON.stringify(hist));
}
function lastSessions(){ return JSON.parse(localStorage.getItem(SESSKEY(App.user.name))||'[]'); }
function openResultsSummary(){
  if(!App.user) return alert('Escolha um avatar e fa√ßa login primeiro.');
  const hist = lastSessions();
  if(hist.length===0){ alert('Sem dados ainda. Complete ao menos 1 dia.'); return; }
  renderResultsFromSession(hist[hist.length-1], hist[hist.length-2]);
  goto('results');
}

function computeResults(){
  saveDone(App.selectedDay);
  const byArea = {};
  answers.forEach(a=>{ if(!byArea[a.area]) byArea[a.area]=[]; byArea[a.area].push(a.val); });
  const areaScores = AREAS.map(a=>{
    const arr = byArea[a]||[]; const s = arr.length ? arr.reduce((p,c)=>p+c,0)/arr.length : 0;
    return {area:a, score: +(s/10).toFixed(2)}; // 0‚Äì100 -> 0‚Äì10
  });
  const geral = +(areaScores.reduce((p,c)=>p+c.score,0)/areaScores.length).toFixed(2);
  const session = {date: new Date().toISOString().slice(0,10), day:App.selectedDay, geral, areaScores, moodIn:App.moodIn, moodOut:App.moodOut};
  saveSession(session);
  renderResultsFromSession(session, lastSessions().slice(-2)[0]);
}

function renderResultsFromSession(cur, prev){
  $('#resDates').textContent = `Dia ${cur.day||'‚Äî'} ‚Ä¢ ${cur.date||'‚Äî'}`;
  $('#kpiGeral').textContent = (cur.geral||0).toFixed(2);
  $('#kpiMoodIn').textContent = moodName(cur.moodIn);
  $('#kpiMoodOut').textContent = moodName(cur.moodOut);
  const best = [...cur.areaScores].sort((a,b)=>b.score-a.score)[0];
  const worst = [...cur.areaScores].sort((a,b)=>a.score-b.score)[0];
  $('#kpiBest').textContent = best?.area || '‚Äî';
  $('#kpiWorst').textContent = worst?.area || '‚Äî';
  // popular filtros
  buildFilters();
  // gr√°ficos
  drawRadar(cur, prev);
  drawSeries();
  drawBars(cur);
  // an√°lise e plano
  $('#aiAnalise').innerHTML = aiAnalysis(best,worst,cur.geral||0);
  $('#sugestoes').textContent = suggestPlan(worst?.area, best?.area);
}

function buildFilters(){
  const selA = $('#selArea'), selP = $('#selPeriodo');
  // √Årea
  selA.innerHTML = `<option value="all">Todas as √°reas</option>` + AREAS.map(a=>`<option value="${a}">${a}</option>`).join('');
  // Per√≠odo (j√° est√° no HTML)
  selA.onchange = ()=>{ drawSeries(); drawBars(); refreshAnalysisFromFilters(); };
  selP.onchange = ()=>{ drawSeries(); drawBars(); refreshAnalysisFromFilters(); };
}
function getFilterPeriod(){
  const v = $('#selPeriodo').value;
  if(v==='all') return Infinity;
  const n = parseInt(v,10);
  return isNaN(n)?Infinity:n;
}
function getFilterArea(){
  const v = $('#selArea').value;
  return v==='all'? null : v;
}
function filteredHistory(){
  const hist = lastSessions();
  const n = getFilterPeriod();
  const arr = n===Infinity ? hist : hist.slice(-n);
  return arr;
}
function refreshAnalysisFromFilters(){
  const hist = filteredHistory();
  if(hist.length===0) return;
  // Geral m√©dio no per√≠odo
  const g = +(hist.reduce((p,c)=>p+(c.geral||0),0)/hist.length).toFixed(2);
  // Pior e melhor √°rea no per√≠odo (m√©dia)
  const area = getFilterArea();
  let best=null, worst=null;
  const map={};
  hist.forEach(s=>{
    s.areaScores.forEach(as=>{
      if(area && as.area!==area) return;
      if(!map[as.area]) map[as.area]=[];
      map[as.area].push(as.score);
    });
  });
  const arr = Object.entries(map).map(([area,vals])=>({area, score: +(vals.reduce((p,c)=>p+c,0)/vals.length).toFixed(2)}));
  if(arr.length){
    best = [...arr].sort((a,b)=>b.score-a.score)[0];
    worst = [...arr].sort((a,b)=>a.score-b.score)[0];
  }
  $('#aiAnalise').innerHTML = aiAnalysis(best,worst,g);
  $('#sugestoes').textContent = suggestPlan(worst?.area, best?.area);
}

/* === Gr√°ficos === */
function drawRadar(cur, prev){
  const wrap=$('#radarWrap'); wrap.innerHTML='';
  const W=Math.max(280, wrap.clientWidth-20), H=Math.max(160, wrap.clientHeight-20), cx=W/2, cy=H/2, R=Math.min(W,H)*0.42;
  const svgNS='http://www.w3.org/2000/svg', svg=document.createElementNS(svgNS,'svg'); svg.setAttribute('viewBox',`0 0 ${W} ${H}`);
  function pts(scores){ return (scores||[]).map((v,i)=>{ const ang=(Math.PI*2*i/AREAS.length)-Math.PI/2; const r=R*((v.score||0)/10); return `${(cx+r*Math.cos(ang)).toFixed(1)},${(cy+r*Math.sin(ang)).toFixed(1)}`; }).join(' '); }
  for(let k=2;k<=10;k+=2){ const c=document.createElementNS(svgNS,'circle'); c.setAttribute('cx',cx); c.setAttribute('cy',cy); c.setAttribute('r',R*(k/10)); c.setAttribute('fill','none'); c.setAttribute('stroke','#2e3342'); c.setAttribute('stroke-dasharray','4 6'); svg.appendChild(c); }
  if(prev){ const p=document.createElementNS(svgNS,'polygon'); p.setAttribute('points', pts(prev.areaScores)); p.setAttribute('fill','none'); p.setAttribute('stroke','#9aa4c8'); p.setAttribute('stroke-dasharray','6 4'); p.setAttribute('stroke-width','2'); svg.appendChild(p); }
  const poly=document.createElementNS(svgNS,'polygon'); poly.setAttribute('points', pts(cur.areaScores)); poly.setAttribute('fill','rgba(247,208,64,.18)'); poly.setAttribute('stroke','var(--accent)'); poly.setAttribute('stroke-width','2'); svg.appendChild(poly);
  wrap.appendChild(svg);
}
function drawSeries(){
  const wrap=$('#seriesWrap'); wrap.innerHTML='';
  const histAll=lastSessions();
  if(histAll.length===0){ wrap.textContent='‚Äî'; return; }
  const area = getFilterArea();
  const period = getFilterPeriod();
  const hist = period===Infinity? histAll : histAll.slice(-period);
  // S√©rie do geral ou da √°rea selecionada (m√©dia das √°reas da sess√£o)
  const data = hist.map(s=>{
    const v = area ? (s.areaScores.find(x=>x.area===area)?.score||0) : (s.geral||0);
    return {date:s.date, val:v};
  });
  const W=Math.max(280, wrap.clientWidth-20), H=Math.max(120, wrap.clientHeight-20), p=10, xs=i=>p+i*((W-2*p)/(Math.max(1,data.length-1))), ys=v=>H-p-((v/10)*(H-2*p));
  const svgNS='http://www.w3.org/2000/svg', svg=document.createElementNS(svgNS,'svg'); svg.setAttribute('viewBox',`0 0 ${W} ${H}`);
  const path = document.createElementNS(svgNS,'path'); path.setAttribute('d', data.map((pt,i)=>`${i?'L':'M'} ${xs(i)} ${ys(pt.val)}`).join(' ')); path.setAttribute('fill','none'); path.setAttribute('stroke','#5fb3ff'); path.setAttribute('stroke-width','2'); svg.appendChild(path);
  data.forEach((pt,i)=>{ const c=document.createElementNS(svgNS,'circle'); c.setAttribute('cx',xs(i)); c.setAttribute('cy',ys(pt.val)); c.setAttribute('r',3.4); c.setAttribute('fill','#f7d040'); svg.appendChild(c); });
  wrap.appendChild(svg);
}
function drawBars(session){
  const wrap=$('#barsWrap'); wrap.innerHTML='';
  const areaFilter=getFilterArea();
  let data=[];
  if(areaFilter){
    // Barras: hist√≥rico recente daquela √°rea (√∫ltimas N sess√µes)
    const hist = filteredHistory();
    data = hist.map(s=>({label:s.date, score:(s.areaScores.find(a=>a.area===areaFilter)?.score)||0})).slice(-12);
  }else{
    // Barras: √°reas da sess√£o atual (ranking)
    const s = session || lastSessions().slice(-1)[0];
    data = [...(s?.areaScores||[])].sort((a,b)=>b.score-a.score).map(d=>({label:d.area, score:d.score}));
  }
  const W=Math.max(280, wrap.clientWidth-20), H=Math.max(140, wrap.clientHeight-20), p=10;
  const yStep=(H-2*p)/Math.max(1,data.length);
  const svgNS='http://www.w3.org/2000/svg', svg=document.createElementNS(svgNS,'svg'); svg.setAttribute('viewBox',`0 0 ${W} ${H}`);
  data.forEach((d,i)=>{
    const y=p+i*yStep, w=(W-140)* ((d.score||0)/10);
    const r=document.createElementNS(svgNS,'rect'); r.setAttribute('x',130); r.setAttribute('y',y); r.setAttribute('width',w); r.setAttribute('height',yStep-8); r.setAttribute('fill','rgba(247,208,64,.25)'); r.setAttribute('stroke','var(--accent)'); svg.appendChild(r);
    const t=document.createElementNS(svgNS,'text'); t.setAttribute('x',6); t.setAttribute('y',y+ (yStep/2)); t.setAttribute('dominant-baseline','middle'); t.setAttribute('fill','#cfe2ff'); t.textContent = `${d.label}`; svg.appendChild(t);
    const s=document.createElementNS(svgNS,'text'); s.setAttribute('x',130+w+6); s.setAttribute('y',y+(yStep/2)); s.setAttribute('dominant-baseline','middle'); s.setAttribute('fill','#eaf0ff'); s.textContent=(d.score||0).toFixed(2); svg.appendChild(s);
  });
  wrap.appendChild(svg);
}

/* ===== An√°lise & Plano ===== */
function aiAnalysis(best,worst,geral){
  const alert = worst && worst.score<=4.0 ? '‚ö†Ô∏è Aten√ß√£o cr√≠tica' : geral<5 ? '‚ö†Ô∏è Abaixo da meta' : '‚úÖ Est√°vel';
  const rec  = worst ? `Foco t√°tico: <b>${worst.area}</b> (subir 1 ponto em 7 dias).` : '';
  const pos  = best ? `Alavanca: <b>${best.area}</b> (replicar pr√°tica).` : '';
  return `${alert} ‚Äî Geral ${Number(geral||0).toFixed(2)}/10. ${rec} ${pos}`.trim();
}
function suggestPlan(lowArea, highArea){
  const mapa={
    "Sa√∫de F√≠sica B√°sica":["Sono 7‚Äì8h","Hidrata√ß√£o visual","Caminhada 20min"],
    "Resili√™ncia Emocional":["Respira√ß√£o 4-4-6 (3x)","Nomear emo√ß√£o","Pedir ajuda"],
    "Performance e Vitalidade":["1 bloco foco (25min)","1 pausa consciente (2min)","3 MITs de amanh√£"]
  };
  const a = mapa[lowArea] || ["1 micro-a√ß√£o (‚â§10 min)","Repetir 7 dias","Revisar sem culpa"];
  const b = highArea ? `Alavancar ${highArea}: consolidar rotina.` : '';
  return `Plano de 3 passos para ${lowArea||'o ponto fraco'}: ${a.join(' ‚Ä¢ ')}. ${b}`;
}
function moodName(n){ return ({1:'üòî',2:'üòü',3:'üòê',4:'üôÇ',5:'üòÉ'})[n] || '‚Äî'; }

/* ===== E-mail ===== */
$('#btnEmail').addEventListener('click', ()=>{
  const sess = lastSessions().slice(-1)[0]; if(!sess) return alert('Sem dados.');
  const body = encodeURIComponent(
`Relat√≥rio ‚Äî Bora‚Ä¶ Crescer!
Dia ${sess.day} (${sess.date})
Geral: ${sess.geral}/10
Mood: in√≠cio ${moodName(sess.moodIn)} ‚Ä¢ final ${moodName(sess.moodOut)}
Piores √°reas: ${[...sess.areaScores].sort((a,b)=>a.score-b.score).slice(0,3).map(x=>x.area+': '+x.score).join(', ')}
Melhores √°reas: ${[...sess.areaScores].sort((a,b)=>b.score-a.score).slice(0,3).map(x=>x.area+': '+x.score).join(', ')}

Obs.: este app n√£o substitui profissionais especializados.`
  );
  location.href=`mailto:?subject=Relat√≥rio ‚Äî Bora Crescer&body=${body}`;
});
$('#btnFinish').addEventListener('click', ()=> location.reload());

/* ===== Contagem regressiva ===== */
function runWipe(n, phrase, done){
  const w=$('#wipe'), c=$('#countNum'), p=$('#countPhrase'); w.classList.add('show'); p.textContent=phrase; let left=n; c.textContent=left;
  const t=setInterval(()=>{ left--; if(left<=0){ clearInterval(t); w.classList.remove('show'); done(); } else c.textContent=left; },1000);
}
/* Frases D1..D31 */
const phrasesDD = [
"Disciplina √© liberdade.","Sem pressa, sem pausa.","Pequenos passos, grandes rotas.","Foco no que mexe o ponteiro.",
"Respira e executa.","Hoje vence o ontem.","Fa√ßa o simples bem feito.","Const√¢ncia > intensidade.",
"O come√ßo carrega o fim.","N√£o negocie com a mente.","1% melhor j√° √© vit√≥ria.","Energia segue a aten√ß√£o.",
"Micro-a√ß√µes movem montanhas.","Descomplique o caminho.","O que n√£o mede, n√£o melhora.","Cuidado com distra√ß√µes.",
"Voc√™ √© o sistema que repete.","Corta 1 ru√≠do por 72h.","Anota e aprende.","Repete o que funciona.",
"Padroniza o essencial.","Tempo tem dono: voc√™.","Diga n√£o ao sup√©rfluo.","Ganho composto do h√°bito.",
"Priorize o que importa.","Aprenda ensinando.","Erros viram ajuste.","Ambiente puxa comportamento.",
"Simplicidade gera escala.","Bora‚Ä¶ Crescer!"
];
/* ===== Neon de fundo por categoria (leve) ===== */
function neonBackdrop(area){
  document.body.style.boxShadow = `inset 0 0 120px rgba(95,179,255,.08), inset 0 0 300px rgba(247,208,64,.06)`;
}

/* ===== Re-render em resize na aba de resultados ===== */
window.addEventListener('resize', ()=>{
  const resAtivo = $('#results').classList.contains('active');
  if(!resAtivo) return;
  const hist = lastSessions();
  const cur = hist.slice(-1)[0];
  if(!cur) return;
  const prev = hist.slice(-2)[0];
  drawRadar(cur, prev);
  drawSeries();
  drawBars(cur);
}, {passive:true});
</script>
</body>
</html>